from elasticsearch import Elasticsearch

es = Elasticsearch()


def get_all(index):
    res = es.search(index=index, body={
            "query": {
                "match_all": {}
            }
        }, size=1000)

    malware_list = []
    beningware_list = []
    for r in res['hits']['hits']:
        if r['_source']['label'] == 'beningware':
            beningware_list.append(r['_source']['report'])
        else:
            malware_list.append(r['_source']['report'])

    print('number of beningware {}'.format(len(beningware_list)))
    print('number of malware {}'.format(len(malware_list)))

    malware_labels = [1] * len(malware_list)
    beningware_labels = [0] * len(beningware_list)

    malware_list.extend(beningware_list)
    malware_labels.extend(beningware_labels)

    return malware_list, malware_labels